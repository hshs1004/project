# 소프트웨어공학 개인 과제
20210014 남현식

소프트웨어공학이란 사전적 의미로 컴퓨터 프로그램 및 그와 관련된 문서들을 통틀어 이르고 컴퓨터를 관리하는 시스템 프로그램과, 문제 해결에 이용되는 다양한 형태의 응용 프로그램으로 나뉩니다.
예로 윈도우, 리눅스, 유닉스와 같은 운영체제와 어셈블러, 컴파일러, 인터프리터와 같은 언어 번역 프로그램이 대표적인 시스템 소프트웨어입니다. 
대표적인 응용 소프트웨어로는 한글, 워드, 엑셀, 파워포인트, 오라클 또는 액세스와 같은 데이터베이스 관리 시스템, 포토샵, 웹 브라우저 및 FTP와 같은 통신 프로그램이 있습니다.

소프트웨어 적용 사례로는 버스정류장 모니터, 스마트폰 지도, loT(사물 인터넷), 스마트팜, 인터넷 은행, VR(가상현실) 등이 있습니다. 이 중에서 제가 주제로 선택한 사례는 인터넷 은행입니다.

인터넷 은행 시스템을 시퀀스 다이어그램으로 만들기 위해 코드를 만들었습니다. 코드는 시퀀스 다이어그램 파일에 작성했습니다.
작성한 코드로 시퀀스 다이어그램을 만들면 
![image](https://github.com/user-attachments/assets/f0bc0a2e-20b6-4abe-b329-392f2eee24b0)
위 사진과 같습니다.

이후 시퀀스 다이어그램을 기반으로 코드를 만들고 project 폴더에 첨부하였습니다. 
project 폴더에는 app.py, database.py, external_gateway.py, schema.sql 파일들이 있습니다.
app.py 파일을 단계별로 설명하자면 
1. 전체 구조와 목적: Flask 웹 프레임워크를 사용하여 간단한 은행 서비스를 구현합니다.
이 프로그램은 사용자 로그인을 처리하는 /login 엔드포인트와 계좌 간 이체를 처리하는 /transfer 엔드포인트를 제공합니다.
2. /login 엔드포인트:
- 클라이언트가 JSON 형식으로 사용자 이름과 비밀번호를 전송하면, find_user_by_credentials 함수를 호출하여 사용자를 인증합니다.
- 인증이 성공하면 "success" 상태와 함께 사용자 ID를 JSON으로 반환합니다.
- 인증에 실패할 경우 "fail" 상태와 "Invalid credentials" 오류 메시지, 401 상태 코드가 포함된 JSON을 반환합니다.
3. /transfer 엔드포인트:
- 클라이언트로부터 출발 계좌, 도착 계좌, 이체 금액 정보를 JSON으로 받습니다.
- get_account_balance 함수를 사용해 출발 계좌의 잔액을 확인하고, 잔액이 부족하면 "잔액 부족" 메시지와 400 상태 코드를 반환합니다.
- 잔액이 충분한 경우, 외부 금융망에 이체 승인을 요청합니다. (request_transfer_to_gateway 함수 호출)
- 외부 금융 승인에 실패하면 "외부 금융망 오류" 메시지와 500 상태 코드를 반환합니다.
- 외부 승인이 완료되면, update_balances_and_log_transfer 함수를 호출하여 데이터베이스 트랜잭션을 수행하여 잔액을 업데이트하고 이체 로그를 기록합니다.
- 트랜잭션이 성공하면 "이체 완료" 메시지를 반환하고, 실패 시 500 상태 코드와 "DB 처리 오류" 메시지를 반환합니다.
4. 앱 실행:
- main 블록에서 Flask 개발 서버가 디버그 모드로 실행되어, 해당 파일이 직접 실행될 경우 서비스가 시작됩니다.
5. 외부 모듈과의 통합:
- 데이터베이스 모듈(database)을 사용하여 사용자 인증과 계좌 잔액 조회, 트랜잭션 처리를 수행합니다.
- 외부 금융망 모듈(external_gateway)을 사용하여 이체 승인 요청을 처리합니다.

database.py 파일은 
1. 전체 구조와 목적:
- 이 파일은 "bank.db"라는 SQLite 데이터베이스와 상호작용하기 위한 유틸리티 함수들을 포함하고 있습니다.
- 함수들은 사용자 인증, 계정 잔액 조회, 그리고 두 계정 간의 금액 이체 기능을 제공합니다.
2. 함수별 동작:
A. get_connection:
- 역할: bank.db에 연결하여 데이터베이스 Connection 객체를 반환합니다.
- 처리: sqlite3.connect() 함수를 사용하여 데이터베이스에 연결합니다.
B. find_user_by_credentials:
- 역할: 입력된 username과 password에 해당하는 사용자를 users 테이블에서 검색합니다.
- 처리:
1. get_connection()을 호출하여 데이터베이스에 연결합니다.
2. 커서를 생성한 후, 파라미터 쿼리를 사용하여 사용자를 검색합니다.
3. 첫 번째 검색 결과를 fetchone()으로 가져오고, 연결을 종료한 후 결과를 반환합니다.
C. get_account_balance:
- 역할: 특정 사용자의 계정 잔액을 accounts 테이블에서 조회합니다.
- 처리:
1. 데이터베이스 연결 및 커서 생성을 수행합니다.
2. user_id로 잔액을 조회하고, 결과가 있으면 잔액 정보를 반환합니다.
D. update_balances_and_log_transfer:
- 역할: 한 계정에서 다른 계정으로 금액을 이체하고, 이체 내역을 transfers 테이블에 기록합니다.
- 처리:
1. 데이터베이스 연결 및 커서를 생성한 후, 송금자 계정에서 금액 차감 SQL을 실행합니다.
2. 수취인 계정에 해당 금액을 추가하는 SQL을 실행합니다.
3. transfers 테이블에 이체 정보를 삽입합니다.
4. 모든 작업이 성공하면 커밋하여 데이터를 저장하고, 오류 발생 시 롤백 처리합니다.
3. 주요 구현 기법:
- 파라미터화된 SQL 쿼리를 사용하여 SQL 인젝션 공격을 방지합니다.
- 작업 후 반드시 데이터베이스 연결을 종료하여 리소스를 적절하게 관리합니다.
- 트랜잭션을 적용하여 데이터 일관성을 보장합니다.
이와 같이 database.py 파일은 사용자 인증, 계정 조회, 그리고 안전한 이체 프로세스 구현을 위한 모듈로 작동합니다.

external_gateway.py 파일은
1. 파일의 목적:
- 이 파일은 외부 금융 네트워크로의 전송 요청을 모의하기 위한 함수를 정의합니다.
- 실제 외부 시스템과 연결하지 않고, 단순히 동작 모의를 위해 작성되었습니다.
2. 함수 정의 및 매개변수:
- 함수 이름: request_transfer_to_gateway
- 매개변수:
• from_user_id: 이체를 요청하는 사용자의 식별자입니다.
• to_user_id: 이체를 받는 사용자의 식별자입니다.
• amount: 이체할 금액을 의미합니다.
3. 코드 동작:
- 함수는 실행 시 print 함수를 이용하여 '외부 게이트웨이 요청' 메시지를 출력합니다.
- 출력 메시지는 전송자, 수신자, 이체 금액을 포함하여 로그 기록 또는 디버깅에 도움이 됩니다.
4. 반환 값:
- 함수는 항상 True를 반환합니다.
- 이는 요청이 성공적으로 처리되었음을 의미하는 모의(success) 결과입니다.
이 함수의 목적은 금액 이체 행위를 모의하여, 실제 외부 금융 시스템과의 복잡한 통신 없이도
단순히 메시지 출력과 성공 표시를 통해 동작을 구현하는 것입니다.

schema.sql 파일은
1. 먼저 main 함수 내부에 explanation 변수에 스키마.sql 파일에 정의된 각 테이블의 역할과 구조에 관한 상세한 설명 문자열을 저장합니다.
2. 설명 문자열은 총 6단계로 구성되어 있으며, 각 단계에서는 전체 스키마의 개요, 각 테이블(users, accounts, transfers)의 컬럼 및 제약 조건, 그리고 스키마의 전반적인 데이터 무결성 유지 방법을 설명합니다.
3. print 함수를 사용하여 설명 문자열을 출력함으로써 사용자가 데이터베이스 스키마의 목적과 구조를 쉽게 이해할 수 있도록 합니다.
4. 마지막으로, if name == "main": 조건문을 통해 이 파이썬 스크립트가 직접 실행될 때 main 함수가 호출되어 설명이 출력됩니다.
5. 이 프로그램은 별도의 데이터 처리 없이 단순히 스키마.sql 파일의 내용을 단계별로 설명하는 역할을 수행합니다.

이후, 시퀀스 다이어그램을 기반으로 한 코드를 간략하게 모듈평가를 하여 모듈평가 파일에 작성하였습니다.

이번 과제를 통해 저는 일상 속 소프트웨어 사용 사례가 되게 많고 앞으로도 더 많아질 것 같다고 느꼈습니다. 일상 속 많은 소프트웨어 사용 사례 중 인터넷 은행을 선정하게 된 이유는 
주변이나 저 또한 되게 자주 사용하면서 별다른 생각을 안하였지만 막상 어떻게 돈이 보내지고 상대방에게 전달되는지 되게 궁금해져 인터넷 은행을 선정했습니다. 
이번 과제를 통해 되게 많은 사람들이 이용하는 인터넷 은행에 대해 자세히 알게 되어 의미 있고 깃허브를 이용한 첫 과제여서 서툴었지만 유익한 시간이었던 것 같습니다.
